import{a as m,t as w}from"./Deu4X4aL.js";import"./wOyGJXk8.js";import{ae as L,af as O,M as U,y as V,i as N,aD as X,aE as q,a4 as F,aF as R,aG as Y,X as Q,ap as Z,p as W,s as b,a as z,g as i,c as _,b as f,d as u,r as d,t as M,f as ee}from"./BHXzz-95.js";import{d as B,s as te}from"./4570wjtE.js";import{p as x,i as ae}from"./DUyj2MmG.js";let $=!1;function C(){$||($=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const a of e.target.elements)(t=a.__on_r)==null||t.call(a)})},{capture:!0}))}function re(e){var t=U,a=V;L(null),O(null);try{return e()}finally{L(t),O(a)}}function oe(e,t,a,o=a){e.addEventListener(t,()=>re(a));const r=e.__on_r;r?e.__on_r=()=>{r(),o(!0)}:e.__on_r=()=>o(!0),C()}function I(e){if(N){var t=!1,a=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var o=e.value;P(e,"value",null),e.value=o}if(e.hasAttribute("checked")){var r=e.checked;P(e,"checked",null),e.checked=r}}};e.__on_r=a,X(a),C()}}function P(e,t,a,o){var r=e.__attributes??(e.__attributes={});N&&(r[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||r[t]!==(r[t]=a)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[q]=a),a==null?e.removeAttribute(t):typeof a!="string"&&ne(e).includes(t)?e[t]=a:e.setAttribute(t,a))}var G=new Map;function ne(e){var t=G.get(e.nodeName);if(t)return t;G.set(e.nodeName,t=[]);for(var a,o=e,r=Element.prototype;r!==o;){a=R(o);for(var n in a)a[n].set&&t.push(n);o=F(o)}return t}function S(e,t,a=t){var o=Y();oe(e,"input",r=>{var n=r?e.defaultValue:e.value;if(n=T(e)?D(n):n,a(n),o&&n!==(n=t())){var c=e.selectionStart,s=e.selectionEnd;e.value=n??"",s!==null&&(e.selectionStart=c,e.selectionEnd=Math.min(s,e.value.length))}}),(N&&e.defaultValue!==e.value||Q(t)==null&&e.value)&&a(T(e)?D(e.value):e.value),Z(()=>{var r=t();T(e)&&r===D(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function T(e){var t=e.type;return t==="number"||t==="range"}function D(e){return e===""?null:+e}const se=async(e,t,a,o,r,n)=>{t==null||t.setItem("subject",i(a)),t==null||t.setItem("username",i(o));const c=await fetch(`${r}/api/test/jwt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sub:i(a),username:i(o),exp:Math.floor(new Date().setDate(new Date().getDate()+Number(i(n)))/1e3)})}),s=await c.json();c.status===200&&(t==null||t.setItem("jwt",s.data))};var ie=async(e,t,a)=>{const o=t==null?void 0:t.getItem("jwt");console.log(o);const r=await fetch(`${a}/api/test/auth`,{headers:{Authorization:`Bearer ${o}`}});console.log(r);const n=await r.json();console.log(n)},ce=w('<div class="jwt_helper"><div><span>Create JWT</span> <input type="text" placeholder="Subject"> <input type="text" placeholder="Username"> <input type="number" placeholder="Expiration"> <button>Generate</button></div> <div><span>Test JWT auth</span> <button>Test Auth</button></div></div>');function ve(e,t){W(t,!0);const a=typeof window<"u"?window.localStorage:null,o="http://localhost:8080";let r=b(x((a==null?void 0:a.getItem("subject"))||"")),n=b(x((a==null?void 0:a.getItem("username"))||"")),c=b(x((a==null?void 0:a.getItem("days"))||5));var s=ce(),g=u(s),y=_(u(g),2);I(y);var j=_(y,2);I(j);var k=_(j,2);I(k);var p=_(k,2);p.__click=[se,a,r,n,o,c],d(g);var l=_(g,2),h=_(u(l),2);h.__click=[ie,a,o],d(l),d(s),S(y,()=>i(r),v=>f(r,v)),S(j,()=>i(n),v=>f(n,v)),S(k,()=>i(c),v=>f(c,v)),m(e,s),z()}B(["click"]);const _e=(e,t,a)=>{t.removeItem("jwt"),f(a,!1)},le=(e,t)=>f(t,!1);var ue=w("<div><button> </button></div>"),de=(e,t)=>{f(t,!0)},fe=w('<button>Login</button>  <dialog class="svelte-125g2ze"><button>X</button> <div><input type="text" placeholder="Username"> <button>Log in</button> <!></div></dialog>',1),pe=w("<div><!></div>");function he(e,t){W(t,!0);const a=typeof window<"u"?window.localStorage:null;let o=b(!1),r=b(""),n=b(!1);const c=a==null?void 0:a.getItem("jwt"),s=c?JSON.parse(atob(c.split(".")[1])):null;s!=null&&s.exp&&s.exp*1e3>Date.now()&&(f(o,!0),f(r,x(s.username)));var g=pe(),y=u(g);{var j=p=>{var l=ue(),h=u(l);h.__click=[_e,a,o];var v=u(h,!0);d(h),d(l),M(()=>te(v,i(r))),m(p,l)},k=p=>{var l=fe(),h=ee(l);h.__click=[de,n];var v=_(h,2),E=u(v);E.__click=[le,n];var J=_(E,2),A=u(J);I(A);var H=_(A,4);ve(H,{}),d(J),d(v),M(()=>v.open=i(n)),S(A,()=>i(r),K=>f(r,K)),m(p,l)};ae(y,p=>{i(o)?p(j):p(k,!1)})}d(g),m(e,g),z()}B(["click"]);var ge=w("<div>Search</div>");function me(e){var t=ge();m(e,t)}var be=w('<header class="svelte-jnleut"><a href="/" class="svelte-jnleut"><h1>Known Socially</h1></a> <!> <!></header>');function Ie(e){var t=be(),a=_(u(t),2);me(a);var o=_(a,2);he(o,{}),d(t),m(e,t)}export{Ie as H,ve as J,S as b,oe as l,I as r,P as s};
