import{a as m,t as w}from"./Deu4X4aL.js";import"./wOyGJXk8.js";import{ae as O,af as $,M as V,y as X,i as E,aD as q,aE as F,a4 as R,aF as Y,aG as Q,X as Z,ap as ee,p as G,s as b,a as H,g as v,c as l,b as p,d,r as f,t as M,f as te}from"./BHXzz-95.js";import{d as W,s as ae}from"./4570wjtE.js";import{p as S,i as re}from"./DUyj2MmG.js";let P=!1;function C(){P||(P=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const a of e.target.elements)(t=a.__on_r)==null||t.call(a)})},{capture:!0}))}function oe(e){var t=V,a=X;O(null),$(null);try{return e()}finally{O(t),$(a)}}function ne(e,t,a,o=a){e.addEventListener(t,()=>oe(a));const r=e.__on_r;r?e.__on_r=()=>{r(),o(!0)}:e.__on_r=()=>o(!0),C()}function x(e){if(E){var t=!1,a=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var o=e.value;z(e,"value",null),e.value=o}if(e.hasAttribute("checked")){var r=e.checked;z(e,"checked",null),e.checked=r}}};e.__on_r=a,q(a),C()}}function z(e,t,a,o){var r=e.__attributes??(e.__attributes={});E&&(r[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||r[t]!==(r[t]=a)&&(t==="style"&&"__styles"in e&&(e.__styles={}),t==="loading"&&(e[F]=a),a==null?e.removeAttribute(t):typeof a!="string"&&se(e).includes(t)?e[t]=a:e.setAttribute(t,a))}var B=new Map;function se(e){var t=B.get(e.nodeName);if(t)return t;B.set(e.nodeName,t=[]);for(var a,o=e,r=Element.prototype;r!==o;){a=Y(o);for(var n in a)a[n].set&&t.push(n);o=R(o)}return t}function I(e,t,a=t){var o=Q();ne(e,"input",r=>{var n=r?e.defaultValue:e.value;if(n=D(e)?N(n):n,a(n),o&&n!==(n=t())){var s=e.selectionStart,i=e.selectionEnd;e.value=n??"",i!==null&&(e.selectionStart=s,e.selectionEnd=Math.min(i,e.value.length))}}),(E&&e.defaultValue!==e.value||Z(t)==null&&e.value)&&a(D(e)?N(e.value):e.value),ee(()=>{var r=t();D(e)&&r===N(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function D(e){var t=e.type;return t==="number"||t==="range"}function N(e){return e===""?null:+e}const ie=async(e,t,a,o,r,n)=>{t==null||t.setItem("subject",v(a)),t==null||t.setItem("username",v(o));const s=await fetch(`${r}/api/test/jwt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sub:v(a),username:v(o),exp:Math.floor(new Date().setDate(new Date().getDate()+Number(v(n)))/1e3)})}),i=await s.json();s.status===200&&(t==null||t.setItem("jwt",i.data))};var ce=async(e,t,a)=>{const o=t==null?void 0:t.getItem("jwt");console.log(o);const r=await fetch(`${a}/api/test/auth`,{headers:{Authorization:`Bearer ${o}`}});console.log(r);const n=await r.json();console.log(n)},ve=w('<div class="jwt_helper"><div><span>Create JWT</span> <input type="text" placeholder="Subject"> <input type="text" placeholder="Username"> <input type="number" placeholder="Expiration"> <button>Generate</button></div> <div><span>Test JWT auth</span> <button>Test Auth</button></div></div>');function le(e,t){G(t,!0);const a=typeof window<"u"?window.localStorage:null,o="http://localhost:8080";let r=b(S((a==null?void 0:a.getItem("subject"))||"")),n=b(S((a==null?void 0:a.getItem("username"))||"")),s=b(S((a==null?void 0:a.getItem("days"))||5));var i=ve(),_=d(i),g=l(d(_),2);x(g);var y=l(g,2);x(y);var k=l(y,2);x(k);var A=l(k,2);A.__click=[ie,a,r,n,o,s],f(_);var u=l(_,2),h=l(d(u),2);h.__click=[ce,a,o],f(u),f(i),I(g,()=>v(r),c=>p(r,c)),I(y,()=>v(n),c=>p(n,c)),I(k,()=>v(s),c=>p(s,c)),m(e,i),H()}W(["click"]);const _e=(e,t,a,o,r)=>{fetch(`${t}/api/protected/logout`,{method:"POST",headers:{Authorization:`Bearer ${a}`}}),o.removeItem("jwt"),p(r,!1)},ue=(e,t)=>p(t,!1);var de=w("<div><button> </button></div>"),fe=(e,t)=>{p(t,!0)},pe=w('<button>Login</button>  <dialog class="svelte-125g2ze"><button>X</button> <div><input type="text" placeholder="Username"> <button>Log in</button> <!></div></dialog>',1),he=w("<div><!></div>");function ge(e,t){G(t,!0);const a="http://localhost:8080",o=typeof window<"u"?window.localStorage:null;let r=b(!1),n=b(""),s=b(!1);const i=o==null?void 0:o.getItem("jwt"),_=i?JSON.parse(atob(i.split(".")[1])):null;_!=null&&_.exp&&_.exp*1e3>Date.now()&&(p(r,!0),p(n,S(_.username)));var g=he(),y=d(g);{var k=u=>{var h=de(),c=d(h);c.__click=[_e,a,i,o,r];var j=d(c,!0);f(c),f(h),M(()=>ae(j,v(n))),m(u,h)},A=u=>{var h=pe(),c=te(h);c.__click=[fe,s];var j=l(c,2),J=d(j);J.__click=[ue,s];var L=l(J,2),T=d(L);x(T);var K=l(T,4);le(K,{}),f(L),f(j),M(()=>j.open=v(s)),I(T,()=>v(n),U=>p(n,U)),m(u,h)};re(y,u=>{v(r)?u(k):u(A,!1)})}f(g),m(e,g),H()}W(["click"]);var me=w("<div>Search</div>");function be(e){var t=me();m(e,t)}var we=w('<header class="svelte-jnleut"><a href="/" class="svelte-jnleut"><h1>Known Socially</h1></a> <!> <!></header>');function Ie(e){var t=we(),a=l(d(t),2);be(a);var o=l(a,2);ge(o,{}),f(t),m(e,t)}export{Ie as H,le as J,I as b,ne as l,x as r,z as s};
